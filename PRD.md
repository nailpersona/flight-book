# Додавання документа КБП БА/РА до Посібника

## Overview

Додати повний текст Курсу бойової підготовки бомбардувальної та розвідувальної авіації (КБП БА/РА 2021) до системи Посібник на сторінку http://localhost:3000/tabs/guide.

**Мета:** Забезпечити 100% відповідність контенту в базі оригінальному документу `docs/КБП_БА_РА_2021_+08.12_ДОФ_09.12.docx`.

**Контекст:**
- Документ вже створено в базі (document_id = 5, is_visible = false)
- Потребує додавання всіх розділів та додатків
- Таблиці мають бути конвертовані в PNG зображення

**Типи літаків:** Су-24, Су-24МР

## Technical Context

### База даних
- **document_id:** 5 (вже існує, порожній)
- **Таблиці:** `guide_documents`, `guide_sections`
- **Папка для зображень:** `web/public/images/tables/kbp_ba/`

### Очікувана структура (на основі КБП ВА):
```
├── ОСНОВНІ ТЕРМІНИ ТА ВИЗНАЧЕННЯ
├── ПЕРЕЛІК СКОРОЧЕНЬ ТА УМОВНИХ ПОЗНАЧЕНЬ
├── 1. ОРГАНІЗАЦІЙНО-МЕТОДИЧНІ ВКАЗІВКИ
│   ├── 1.1. Структура курсу бойової підготовки
│   ├── 1.2. Вказівки щодо навчання льотного складу
│   │   └── 1.2.1. Загальні положення
│   ├── 1.3. Максимальні перерви в польотах
│   ├── 1.4. Норми нальоту і навантаження
│   │   ├── 1.4.1. Норми нальоту
│   │   ├── 1.4.2. Норми навантаження
│   │   └── ... (1.4.3-1.4.11)
│   └── 1.5. Вказівки з видів льотної підготовки
│       ├── 1.5.1. Техніка пілотування
│       ├── 1.5.2. Повітряна навігація
│       └── ... (1.5.3-1.5.6)
├── 2. ЗАДАЧА ПЕРША – ПІДГОТОВКА ДО БОЙОВИХ ДІЙ ВДЕНЬ
│   ├── 2.1. Методичні вказівки
│   ├── 2.2. Перелік вправ
│   ├── 2.3. Зміст вправ (кожна вправа окремо)
│   └── 2.4. Заходи безпеки
├── 3. ЗАДАЧА ДРУГА – ПІДГОТОВКА ДО БОЙОВИХ ДІЙ ВНОЧІ
│   ├── 3.1. Методичні вказівки
│   ├── 3.2. Перелік вправ
│   ├── 3.3. Зміст вправ
│   └── 3.4. Заходи безпеки
├── 4. ПРОГРАМА ПЕРША – ПІДГОТОВКА ІНСТРУКТОРІВ
│   ├── 4.1. Методичні вказівки
│   ├── 4.2. Вправи для підготовки інструкторів
│   └── 4.3. Заходи безпеки
├── 5. ПРОГРАМА ДРУГА – УДОСКОНАЛЕННЯ ПІДГОТОВКИ
│   ├── 5.1. Методичні вказівки
│   └── 5.2. Вправи на удосконалення
└── ДОДАТКИ
    ├── Додаток 1. Орієнтовний розрахунок польотів
    ├── Додаток 2. Правила ведення радіообміну
    ├── Додаток 3. Нормативи оцінок (~30 таблиць)
    ├── Додаток 4. Відомості здачі заліків
    └── Вкладиш 3.1-3.2 (форми оцінки)
```

### Кількість елементів:
- **Розділів верхнього рівня:** ~10
- **Підрозділів:** ~50
- **Вправ:** ~160
- **Таблиць для PNG:** ~35-40

### Інструкції:
- `GUIDE_INSTRUCTION.md` — правила додавання документів
- **ГОЛОВНЕ:** Контент має бути 100% ідентичним оригіналу
- **ЗАБОРОНЕНО:** Скорочення типу "(пункти 4-16)"
- **ТАБЛИЦІ:** Тільки PNG файли, не base64

## Stories

### Фаза 1: Підготовка та структура

- [x] Story 1: Підготувати текстову версію документа
  - Конвертувати `docs/КБП_БА_РА_2021_+08.12_ДОФ_09.12.docx` у читабельний UTF-8 текст
  - Зберегти як `docs/КБП_БА_РА_text.txt`
  - Done: Файл створено, текст читається коректно

- [x] Story 2: Створити папку для зображень таблиць
  - Створити `web/public/images/tables/kbp_ba/`
  - Done: Папка існує

- [x] Story 3: Проаналізувати структуру документа
  - Визначити всі розділи, підрозділи, кількість пунктів
  - Створити список таблиць з номерами
  - Done: Список збережено в файлі `docs/kbp_ba_structure.txt`

### Фаза 2: Основні розділи (без додатків)

- [ ] Story 4: Додати "ОСНОВНІ ТЕРМІНИ ТА ВИЗНАЧЕННЯ"
  - Прочитати оригінал, порахувати кількість термінів
  - INSERT INTO guide_sections з повним контентом
  - Done: SELECT показує всі терміни, кількість збігається з оригіналом

- [ ] Story 5: Додати "ПЕРЕЛІК СКОРОЧЕНЬ ТА УМОВНИХ ПОЗНАЧЕНЬ"
  - Повний перелік скорочень без скорочень
  - Done: Всі скорочення присутні в базі

- [ ] Story 6: Додати Розділ 1 "ОРГАНІЗАЦІЙНО-МЕТОДИЧНІ ВКАЗІВКИ" (accordion)
  - Створити батьківський розділ з content = NULL
  - Done: Розділ створено, отримано parent_id для підрозділів

- [ ] Story 7: Додати підрозділи 1.1-1.2 Розділу 1
  - 1.1. Структура курсу бойової підготовки
  - 1.2. Вказівки щодо навчання льотного складу
  - 1.2.1. Загальні положення
  - Done: Всі пункти присутні, parent_id встановлено вірно

- [ ] Story 8: Додати підрозділ 1.3 "Максимальні перерви" з таблицями
  - Підготувати PNG зображення таблиць перервів
  - Зберегти як `kbp_ba_table_1_1.png`, `kbp_ba_table_1_2.png`
  - Додати контент з посиланнями на зображення
  - Done: Таблиці відображаються коректно, контент повний

- [ ] Story 9: Додати підрозділ 1.4 "Норми нальоту і навантаження"
  - Всі підпункти 1.4.1-1.4.11 з повним контентом
  - Done: Кількість пунктів збігається з оригіналом

- [ ] Story 10: Додати підрозділ 1.5 "Вказівки з видів ЛП"
  - 1.5.1-1.5.6 з повним контентом
  - Done: Всі вказівки присутні

### Фаза 3: Задача перша (денні польоти)

- [ ] Story 11: Додати Задачу 2 "ПІДГОТОВКА ДО БОЙОВИХ ДІЙ ВДЕНЬ" (accordion)
  - Створити батьківський розділ
  - Done: parent_id отримано

- [ ] Story 12: Додати 2.1 "Методичні вказівки"
  - Повний контент методичних вказівок
  - Done: Всі пункти присутні

- [ ] Story 13: Додати 2.2 "Перелік вправ" з таблицями
  - Підготувати PNG таблиці переліку вправ
  - Done: Таблиці відображаються, вправи читабельні

- [ ] Story 14: Додати 2.3 "Зміст вправ" (частина 1: вправи 1-25)
  - Створити вкладену структуру для кожної вправи
  - Done: 25 вправ додано з повним описом

- [ ] Story 15: Додати 2.3 "Зміст вправ" (частина 2: вправи 26-50)
  - Done: Ще 25 вправ додано

- [ ] Story 16: Додати 2.3 "Зміст вправ" (частина 3: вправи 51-77)
  - Done: Всі вправи Задачі 2 присутні

- [ ] Story 17: Додати 2.4 "Заходи безпеки"
  - Повний контент заходів безпеки
  - Done: Всі пункти присутні

### Фаза 4: Задача друга (нічні польоти)

- [ ] Story 18: Додати Задачу 3 "ПІДГОТОВКА ДО БОЙОВИХ ДІЙ ВНОЧІ" (accordion)
  - Done: parent_id отримано

- [ ] Story 19: Додати 3.1-3.2 (методичні вказівки та перелік вправ)
  - З PNG таблицями переліку вправ
  - Done: Контент повний, таблиці відображаються

- [ ] Story 20: Додати 3.3 "Зміст вправ" (частина 1: вправи 101-130)
  - Done: 30 вправ додано

- [ ] Story 21: Додати 3.3 "Зміст вправ" (частина 2: вправи 131-164)
  - Done: Всі вправи Задачі 3 присутні

- [ ] Story 22: Додати 3.4 "Заходи безпеки при польотах вночі"
  - Done: Всі пункти присутні

### Фаза 5: Програми підготовки

- [ ] Story 23: Додати Програму 4 "ПІДГОТОВКА ІНСТРУКТОРІВ"
  - 4.1 Методичні вказівки
  - 4.2 Вправи для підготовки інструкторів
  - 4.3 Заходи безпеки
  - Done: Всі підрозділи з повним контентом

- [ ] Story 24: Додати Програму 5 "УДОСКОНАЛЕННЯ ПІДГОТОВКИ"
  - 5.1 Методичні вказівки
  - 5.2 Вправи на удосконалення
  - Done: Всі підрозділи з повним контентом

### Фаза 6: Додатки

- [ ] Story 25: Додати "ДОДАТКИ" (accordion)
  - Створити батьківський розділ для додатків
  - Done: parent_id отримано

- [ ] Story 26: Додаток 1 "Орієнтовний розрахунок польотів та нальоту"
  - Підготувати PNG таблиці
  - Done: Таблиці відображаються коректно

- [ ] Story 27: Додаток 2 "Правила ведення радіообміну"
  - Повний текст правил
  - Done: Всі пункти присутні

- [ ] Story 28: Додаток 3 "Нормативи оцінок" (частина 1: таблиці 3.1-3.10)
  - Підготувати 10 PNG таблиць нормативів
  - Зберегти як `kbp_ba_table_3_1.png` ... `kbp_ba_table_3_10.png`
  - Done: Всі таблиці відображаються

- [ ] Story 29: Додаток 3 "Нормативи оцінок" (частина 2: таблиці 3.11-3.20)
  - Ще 10 PNG таблиць
  - Done: Всі таблиці відображаються

- [ ] Story 30: Додаток 3 "Нормативи оцінок" (частина 3: таблиці 3.21-3.32)
  - Останні 12 PNG таблиць
  - Done: Всі ~32 таблиці нормативів присутні

- [ ] Story 31: Додаток 4 "Відомості здачі заліків"
  - PNG зображення форм відомостей
  - Done: Форми відображаються

- [ ] Story 32: Вкладиш 3.1-3.2 (форми оцінки для Су-24/Су-24МР)
  - PNG зображення вкладишів
  - Done: Вкладиші відображаються

### Фаза 7: Фіналізація

- [ ] Story 33: Перевірка цілісності контенту
  - SELECT всіх розділів, перевірити LENGTH(content)
  - Перевірити відсутність base64 зображень
  - Перевірити відсутність скорочень "(пункти...)"
  - Done: SQL перевірка пройшла без помилок

- [ ] Story 34: Зробити документ видимим
  - UPDATE guide_documents SET is_visible = true WHERE id = 5
  - Done: Документ видно на сторінці /tabs/guide

- [ ] Story 35: Візуальна перевірка на фронтенді
  - Відкрити http://localhost:3000/tabs/guide
  - Перевірити всі розділи, розгортання accordion
  - Перевірити відображення таблиць (PNG)
  - Done: UI працює коректно, всі розділи доступні

## Notes

### Ризики:
1. **Кодування документа** — оригінал може мати проблеми з кирилицею
2. **Велика кількість таблиць** — ~35-40 PNG файлів потребують ручного створення
3. **Обсяг контенту** — документ великий, потрібна обережність з SQL INSERT

### Залежності:
- Потрібен доступ до Word для експорту таблиць як зображень
- Потрібен запущений localhost:3000 для перевірки

### Шаблон SQL для INSERT:
```sql
-- Батьківський розділ (accordion)
INSERT INTO guide_sections (document_id, title, parent_id, order_num)
VALUES (5, 'НАЗВА РОЗДІЛУ', NULL, <order_num>);
SELECT id FROM guide_sections WHERE title = 'НАЗВА РОЗДІЛУ';

-- Дочірній розділ (з контентом)
INSERT INTO guide_sections (document_id, title, content, parent_id, order_num)
VALUES (5, 'Назва підрозділу', '**1.** Повний текст...

![table](/images/tables/kbp_ba_table_X_Y.png)

**2.** Наступний пункт...', <parent_id>, <order_num>);
```

### Перевірка після кожного INSERT:
```sql
-- Перевірити довжину та наявність скорочень
SELECT id, title, LENGTH(content),
       CASE WHEN content LIKE '%пункт%' THEN '⚠️ скорочення' ELSE 'OK' END
FROM guide_sections WHERE id = <new_id>;
```
